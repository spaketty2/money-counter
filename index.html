<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>นับเงิน</title>
<style>
  body {
    background: #3a3a3a;
    color: #ffffff;
    font-family: Tahoma, sans-serif;
    margin: 0;
    padding: 10px;
    max-width: 720px;
    margin: auto;
  }
  .row {
    display: flex;
    align-items: center;
    margin: 4px 0;
    flex-wrap: wrap;
  }
  button {
    background: #4c4c4c;
    color: #ffffff;
    border: none;
    padding: 6px 0;
    margin: 2px;
    font-size: 14px;
    border-radius: 4px;
    cursor: pointer;
    width: 50px;
    transition: background 0.15s ease;
  }
  button:active {
    background: #00aaff;
  }
  input[type="text"] {
    background: #5c5c5c;
    color: #ffffff;
    border: none;
    text-align: center;
    font-size: 14px;
    padding: 6px;
    border-radius: 4px;
    margin: 2px;
    width: 60px;
    transition: background 0.15s ease;
  }
  .label {
    flex: 0 0 50px;
    text-align: center;
    font-size: 14px;
  }
  .multiply {
    flex: 1;
    text-align: right;
    font-size: 14px;
    padding-right: 10px;
    min-width: 50px;
  }
  .clear-btn {
    display: flex;
    justify-content: flex-end;
    margin: 12px 0;
  }
  .sum-section {
    display: flex;
    justify-content: flex-end;
    font-weight: bold;
    font-size: 16px;
    margin: 8px 0;
    flex-wrap: wrap;
  }
  .sum-section div {
    margin-left: 10px;
  }
  .floating-label {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    font-weight: bold;
    font-size: 16px;
    margin: 8px 0;
    flex-wrap: wrap;
  }
  .floating-label div {
    margin-left: 10px;
  }
  .floating-label input {
    width: 140px;
    font-size: 16px;
    text-align: right;
    padding: 6px;
    background: #5c5c5c;
    color: #ffffff;
    border: none;
    border-radius: 4px;
    margin-left: 10px;
  }
  .green {
    color: #00ff88;
    min-width: 80px;
    text-align: right;
  }
</style>
</head>
<body>

<div id="frame"></div>

<div class="clear-btn">
  <button onclick="clearAll()" style="width: 120px;">Clear</button>
</div>

<div class="sum-section">
  <div>รวม</div>
  <div id="total-sum" class="green">0</div>
</div>

<div class="floating-label">
  <div>ยอดโอน</div>
  <input type="text" id="transfer" value="0" 
         onfocus="onFocusIn(this)" 
         onblur="onTransferOut(this)" 
         oninput="onTransferChange()">
</div>

<div class="sum-section">
  <div>รวมค่าธรรมเนียม</div>
  <div id="total-fee" class="green">0</div>
</div>

<div class="sum-section">
  <div>ขาดเหลือ</div>
  <div id="total-diff" class="green">0</div>
</div>

<script>
  const prices = {
    bn1000: 1000, bn500: 500, bn100: 100, bn50: 50, bn20: 20,
    c10: 10, c5: 5, c2: 2, c1: 1, p100: 100, n: 1
  };
  const values = {};
  for (let k in prices) values[k] = 0;

  function createRow(key, label) {
    const frame = document.getElementById("frame");
    const row = document.createElement("div");
    row.className = "row";

    row.innerHTML = `
      <button onclick="clearValue('${key}')">C</button>
      <button onclick="changeValue('${key}', -1)">-1</button>
      <div class="label">${label}</div>
      <input type="text" id="${key}" value="0"
             onfocus="onFocusIn(this)" onblur="onFocusOut(this, '${key}')"
             oninput="onValueChange(this, '${key}')">
      <button onclick="changeValue('${key}', 1)">+1</button>
      <button onclick="changeValue('${key}', 10)">+10</button>
      <div class="multiply" id="${key}_mul">0</div>
    `;
    frame.appendChild(row);
  }

  function changeValue(key, delta) {
    values[key] = Math.max(values[key] + delta, 0);
    document.getElementById(key).value = values[key];
    updateMultiply(key);
  }

  function clearValue(key) {
    values[key] = 0;
    document.getElementById(key).value = 0;
    updateMultiply(key);
  }

  function updateMultiply(key) {
    let mul = prices[key] * values[key];
    document.getElementById(key + "_mul").innerText = mul.toLocaleString();
    updateTotal();
  }

  function updateTotal() {
    let total = Object.keys(prices).reduce((sum, k) => sum + prices[k] * values[k], 0);
    document.getElementById("total-sum").innerText = total.toLocaleString();
    updateFeeAndDiff();
  }

  function clearAll() {
    for (let k in prices) clearValue(k);
    document.getElementById("transfer").value = 0;
    updateFeeAndDiff();
  }

  function onFocusIn(input) {
    if (input.value === "0") input.value = "";
    input.style.color = "#ffffff";
  }

  function onFocusOut(input, key) {
    if (!input.value) {
      input.value = "0";
      input.style.color = "#ffffff";
    }
    values[key] = parseInt(input.value) || 0;
    updateMultiply(key);
  }

  function onValueChange(input, key) {
    values[key] = Math.max(parseInt(input.value) || 0, 0);
    updateMultiply(key);
  }

  function onTransferChange() {
    let transfer = parseInt(document.getElementById("transfer").value.replace(/,/g, "")) || 0;
    document.getElementById("transfer").value = transfer.toLocaleString();
    updateFeeAndDiff();
  }

  function onTransferOut(input) {
    if (!input.value) input.value = "0";
    onTransferChange();
  }

  function updateFeeAndDiff() {
    let transfer = parseInt(document.getElementById("transfer").value.replace(/,/g, "")) || 0;
    let fee = transfer + 15;
    document.getElementById("total-fee").innerText = fee.toLocaleString();
    let total = parseInt(document.getElementById("total-sum").innerText.replace(/,/g, "")) || 0;
    let diff = total - fee;
    document.getElementById("total-diff").innerText = diff.toLocaleString();
  }

  const labels = {
    bn1000: '1000', bn500: '500', bn100: '100', bn50: '50', bn20: '20',
    c10: '10', c5: '5', c2: '2', c1: '1', p100: '100', n: '...'
  };
  for (let k in labels) createRow(k, labels[k]);
</script>

</body>
</html>
