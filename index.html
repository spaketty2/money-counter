<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Sepia</title>
  <style>
    * {
      box-sizing: border-box;
      user-select: none; /* ป้องกันการคัดลอกข้อความ */
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: #333;
      color: white;
      font-family: sans-serif;
    }

    body {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding-bottom: 15vh; /* เหลือไว้ 15% ด้านล่าง */
    }

    .container {
      padding: 10px;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 10px;
    }

    td, th {
      padding: 6px;
      text-align: center;
    }

    input[type="number"] {
      width: 60px;
      padding: 6px;
      border-radius: 5px;
      border: none;
      text-align: center;
      font-size: 14px;
    }

    button {
      padding: 6px 10px;
      margin: 2px;
      background-color: #555;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
    }

    button:hover {
      background-color: #777;
    }

    .footer {
      padding: 10px;
    }

    .footer input {
      width: 100px;
      padding: 6px;
      border-radius: 5px;
      border: none;
      text-align: right;
      font-size: 14px;
    }

    .highlight {
      color: lime;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <table id="table"></table>
    <button onclick="clearAll()">Clear</button>
    <div class="footer">
      <div><strong>รวม</strong> <span id="sum" class="highlight">0</span></div>
      <div><strong>ยอดโอน</strong> <input type="number" id="transfer" value="0" oninput="calculate()"></div>
      <div><strong>รวมค่าธรรมเนียม</strong> <span id="feeTotal" class="highlight">0</span></div>
      <div><strong>ขาดเหลือ</strong> <span id="balance" class="highlight">0</span></div>
    </div>
  </div>

  <script>
    const data = [
      ['C', -1, 1000], ['C', -1, 500], ['C', -1, 100], ['C', -1, 50], ['C', -1, 20],
      ['C', -1, 10], ['C', -1, 5], ['C', -1, 2], ['C', -1, 1], ['C', -1, 100], ['C', -1, '...']
    ];

    function createTable() {
      const table = document.getElementById("table");
      data.forEach((row, i) => {
        const tr = document.createElement("tr");

        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });

        const input = document.createElement("input");
        input.type = "number";
        input.value = 0;
        input.min = 0;
        input.oninput = calculate;

        const tdInput = document.createElement("td");
        tdInput.appendChild(input);
        tr.appendChild(tdInput);

        const btn1 = document.createElement("button");
        btn1.textContent = "+1";
        btn1.onclick = () => {
          input.value = parseInt(input.value) + 1;
          calculate();
        };

        const btn10 = document.createElement("button");
        btn10.textContent = "+10";
        btn10.onclick = () => {
          input.value = parseInt(input.value) + 10;
          calculate();
        };

        const tdBtns = document.createElement("td");
        tdBtns.appendChild(btn1);
        tdBtns.appendChild(btn10);
        tr.appendChild(tdBtns);

        const tdTotal = document.createElement("td");
        tdTotal.textContent = "0";
        tdTotal.classList.add("total");
        tr.appendChild(tdTotal);

        table.appendChild(tr);
      });
    }

    function calculate() {
      const table = document.getElementById("table");
      let total = 0;
      let totalFee = 0;

      Array.from(table.rows).forEach((row, i) => {
        const amount = data[i][2];
        const fee = data[i][1];
        const count = parseInt(row.cells[3].firstChild.value || 0);
        const thisTotal = count * amount;
        const thisFee = count * fee;

        row.cells[5].textContent = thisTotal;
        total += thisTotal;
        totalFee += thisFee;
      });

      document.getElementById("sum").textContent = total;
      document.getElementById("feeTotal").textContent = totalFee;

      const transfer = parseInt(document.getElementById("transfer").value || 0);
      const balance = transfer - total - totalFee;
      document.getElementById("balance").textContent = balance;
    }

    function clearAll() {
      const table = document.getElementById("table");
      Array.from(table.rows).forEach((row) => {
        row.cells[3].firstChild.value = 0;
        row.cells[5].textContent = 0;
      });
      document.getElementById("transfer").value = 0;
      calculate();
    }

    createTable();
    calculate();
  </script>
</body>
</html>
